{"ast":null,"code":"import React,{useEffect}from\"react\";import userStore from\"stores/userStore\";import getSocket from\"api/getSocket\";import homeStore from\"stores/homeStore\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";export default function GlobalState(_ref){var children=_ref.children;var current=userStore(function(state){return state.current;});var inc=homeStore(function(state){return state.increment;});useEffect(function(){if(current){var incrementNotification=function incrementNotification(){if(!window.location.pathname.includes(\"/channels/me\")){inc();}};var disconnect=function disconnect(){socket.emit(\"toggleOffline\");socket.disconnect();};var socket=getSocket();socket.emit(\"toggleOnline\");socket.emit(\"joinUser\",current===null||current===void 0?void 0:current.id);socket.on(\"push_to_top\",function(){incrementNotification();});socket.on(\"send_request\",function(){incrementNotification();});window.addEventListener(\"beforeunload\",disconnect);return function(){return disconnect();};}},[current,inc]);return/*#__PURE__*/_jsx(_Fragment,{children:children});}","map":{"version":3,"sources":["/Users/paulndam/Documents/MERN/React-Course/Crash-Course/build-discord/client/src/components/sections/GlobalState.js"],"names":["React","useEffect","userStore","getSocket","homeStore","GlobalState","children","current","state","inc","increment","incrementNotification","window","location","pathname","includes","disconnect","socket","emit","id","on","addEventListener"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,SAAP,KAAsB,kBAAtB,CACA,MAAOC,CAAAA,SAAP,KAAsB,eAAtB,CACA,MAAOC,CAAAA,SAAP,KAAsB,kBAAtB,C,gGAEA,cAAe,SAASC,CAAAA,WAAT,MAAmC,IAAZC,CAAAA,QAAY,MAAZA,QAAY,CAChD,GAAMC,CAAAA,OAAO,CAAGL,SAAS,CAAC,SAACM,KAAD,QAAWA,CAAAA,KAAK,CAACD,OAAjB,EAAD,CAAzB,CACA,GAAME,CAAAA,GAAG,CAAGL,SAAS,CAAC,SAACI,KAAD,QAAWA,CAAAA,KAAK,CAACE,SAAjB,EAAD,CAArB,CAEAT,SAAS,CAAC,UAAM,CACd,GAAIM,OAAJ,CAAa,CACX,GAAMI,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,EAAM,CAClC,GAAI,CAACC,MAAM,CAACC,QAAP,CAAgBC,QAAhB,CAAyBC,QAAzB,CAAkC,cAAlC,CAAL,CAAwD,CACtDN,GAAG,GACJ,CACF,CAJD,CAMA,GAAMO,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvBC,MAAM,CAACC,IAAP,CAAY,eAAZ,EACAD,MAAM,CAACD,UAAP,GACD,CAHD,CAKA,GAAMC,CAAAA,MAAM,CAAGd,SAAS,EAAxB,CACAc,MAAM,CAACC,IAAP,CAAY,cAAZ,EACAD,MAAM,CAACC,IAAP,CAAY,UAAZ,CAAwBX,OAAxB,SAAwBA,OAAxB,iBAAwBA,OAAO,CAAEY,EAAjC,EAEAF,MAAM,CAACG,EAAP,CAAU,aAAV,CAAyB,UAAM,CAC7BT,qBAAqB,GACtB,CAFD,EAIAM,MAAM,CAACG,EAAP,CAAU,cAAV,CAA0B,UAAM,CAC9BT,qBAAqB,GACtB,CAFD,EAIAC,MAAM,CAACS,gBAAP,CAAwB,cAAxB,CAAwCL,UAAxC,EAEA,MAAO,kBAAMA,CAAAA,UAAU,EAAhB,EAAP,CACD,CACF,CA7BQ,CA6BN,CAACT,OAAD,CAAUE,GAAV,CA7BM,CAAT,CA+BA,mBAAO,yBAAGH,QAAH,EAAP,CACD","sourcesContent":["import React, { useEffect } from \"react\";\nimport userStore from \"stores/userStore\";\nimport getSocket from \"api/getSocket\";\nimport homeStore from \"stores/homeStore\";\n\nexport default function GlobalState({ children }) {\n  const current = userStore((state) => state.current);\n  const inc = homeStore((state) => state.increment);\n\n  useEffect(() => {\n    if (current) {\n      const incrementNotification = () => {\n        if (!window.location.pathname.includes(\"/channels/me\")) {\n          inc();\n        }\n      };\n\n      const disconnect = () => {\n        socket.emit(\"toggleOffline\");\n        socket.disconnect();\n      };\n\n      const socket = getSocket();\n      socket.emit(\"toggleOnline\");\n      socket.emit(\"joinUser\", current?.id);\n\n      socket.on(\"push_to_top\", () => {\n        incrementNotification();\n      });\n\n      socket.on(\"send_request\", () => {\n        incrementNotification();\n      });\n\n      window.addEventListener(\"beforeunload\", disconnect);\n\n      return () => disconnect();\n    }\n  }, [current, inc]);\n\n  return <>{children}</>;\n}\n"]},"metadata":{},"sourceType":"module"}