{"ast":null,"code":"import _regeneratorRuntime from\"/Users/paulndam/Documents/MERN/React-Course/Crash-Course/build-discord/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/paulndam/Documents/MERN/React-Course/Crash-Course/build-discord/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";var createImage=function createImage(url){return new Promise(function(resolve,reject){var image=new Image();image.addEventListener(\"load\",function(){return resolve(image);});image.addEventListener(\"error\",function(error){return reject(error);});image.setAttribute(\"crossOrigin\",\"anonymous\");// needed to avoid cross-origin issues on CodeSandbox\nimage.src=url;});};function getRadianAngle(degreeValue){return degreeValue*Math.PI/180;}/**\n * This function was adapted from the one in the ReadMe of https://github.com/DominicTobias/react-image-crop\n * @param {File} imageSrc - Image File url\n * @param {Object} pixelCrop - pixelCrop Object provided by react-easy-crop\n * @param {number} rotation - optional rotation parameter\n */export default function getCroppedImg(_x,_x2){return _getCroppedImg.apply(this,arguments);}function _getCroppedImg(){_getCroppedImg=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(imageSrc,pixelCrop){var rotation,image,canvas,ctx,maxSize,safeArea,data,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:rotation=_args.length>2&&_args[2]!==undefined?_args[2]:0;_context.next=3;return createImage(imageSrc);case 3:image=_context.sent;canvas=document.createElement(\"canvas\");ctx=canvas.getContext(\"2d\");maxSize=Math.max(image.width,image.height);safeArea=2*(maxSize/2*Math.sqrt(2));// set each dimensions to double largest dimension to allow for a safe area for the\n// image to rotate in without being clipped by canvas context\ncanvas.width=safeArea;canvas.height=safeArea;// translate canvas context to a central location on image to allow rotating around the center.\nctx.translate(safeArea/2,safeArea/2);ctx.rotate(getRadianAngle(rotation));ctx.translate(-safeArea/2,-safeArea/2);// draw rotated image and store data.\nctx.drawImage(image,safeArea/2-image.width*0.5,safeArea/2-image.height*0.5);data=ctx.getImageData(0,0,safeArea,safeArea);// set canvas width to final desired crop size - this will clear existing context\ncanvas.width=pixelCrop.width;canvas.height=pixelCrop.height;// paste generated rotate image with correct offsets for x,y crop values.\nctx.putImageData(data,Math.round(0-safeArea/2+image.width*0.5-pixelCrop.x),Math.round(0-safeArea/2+image.height*0.5-pixelCrop.y));// As Base64 string\n// return canvas.toDataURL('image/jpeg');\n// As a blob\nreturn _context.abrupt(\"return\",new Promise(function(resolve){canvas.toBlob(function(file){resolve(file);},\"image/jpeg\");}));case 19:case\"end\":return _context.stop();}}},_callee);}));return _getCroppedImg.apply(this,arguments);}","map":{"version":3,"sources":["/Users/paulndam/Documents/MERN/React-Course/Crash-Course/build-discord/client/src/utils/cropImage.js"],"names":["createImage","url","Promise","resolve","reject","image","Image","addEventListener","error","setAttribute","src","getRadianAngle","degreeValue","Math","PI","getCroppedImg","imageSrc","pixelCrop","rotation","canvas","document","createElement","ctx","getContext","maxSize","max","width","height","safeArea","sqrt","translate","rotate","drawImage","data","getImageData","putImageData","round","x","y","toBlob","file"],"mappings":"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","sourcesContent":["const createImage = (url) =>\n  new Promise((resolve, reject) => {\n    const image = new Image();\n    image.addEventListener(\"load\", () => resolve(image));\n    image.addEventListener(\"error\", (error) => reject(error));\n    image.setAttribute(\"crossOrigin\", \"anonymous\"); // needed to avoid cross-origin issues on CodeSandbox\n    image.src = url;\n  });\n\nfunction getRadianAngle(degreeValue) {\n  return (degreeValue * Math.PI) / 180;\n}\n\n/**\n * This function was adapted from the one in the ReadMe of https://github.com/DominicTobias/react-image-crop\n * @param {File} imageSrc - Image File url\n * @param {Object} pixelCrop - pixelCrop Object provided by react-easy-crop\n * @param {number} rotation - optional rotation parameter\n */\nexport default async function getCroppedImg(imageSrc, pixelCrop, rotation = 0) {\n  const image = await createImage(imageSrc);\n  const canvas = document.createElement(\"canvas\");\n  const ctx = canvas.getContext(\"2d\");\n\n  const maxSize = Math.max(image.width, image.height);\n  const safeArea = 2 * ((maxSize / 2) * Math.sqrt(2));\n\n  // set each dimensions to double largest dimension to allow for a safe area for the\n  // image to rotate in without being clipped by canvas context\n  canvas.width = safeArea;\n  canvas.height = safeArea;\n\n  // translate canvas context to a central location on image to allow rotating around the center.\n  ctx.translate(safeArea / 2, safeArea / 2);\n  ctx.rotate(getRadianAngle(rotation));\n  ctx.translate(-safeArea / 2, -safeArea / 2);\n\n  // draw rotated image and store data.\n  ctx.drawImage(\n    image,\n    safeArea / 2 - image.width * 0.5,\n    safeArea / 2 - image.height * 0.5\n  );\n  const data = ctx.getImageData(0, 0, safeArea, safeArea);\n\n  // set canvas width to final desired crop size - this will clear existing context\n  canvas.width = pixelCrop.width;\n  canvas.height = pixelCrop.height;\n\n  // paste generated rotate image with correct offsets for x,y crop values.\n  ctx.putImageData(\n    data,\n    Math.round(0 - safeArea / 2 + image.width * 0.5 - pixelCrop.x),\n    Math.round(0 - safeArea / 2 + image.height * 0.5 - pixelCrop.y)\n  );\n\n  // As Base64 string\n  // return canvas.toDataURL('image/jpeg');\n\n  // As a blob\n  return new Promise((resolve) => {\n    canvas.toBlob((file) => {\n      resolve(file);\n    }, \"image/jpeg\");\n  });\n}\n"]},"metadata":{},"sourceType":"module"}