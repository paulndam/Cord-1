{"ast":null,"code":"var _jsxFileName = \"/Users/paulndam/Documents/MERN/React-Course/Crash-Course/build-discord/client/src/components/items/message/Message.js\",\n    _s = $RefreshSig$();\n\nimport { Avatar, Box, Flex, Icon, Text, useDisclosure } from \"@chakra-ui/react\";\nimport MemberContextMenu from \"components/menus/MemberContextMenu\";\nimport DeleteMessageModal from \"components/modals/DeleteMessageModal\";\nimport EditMessageModal from \"components/modals/EditMessageModal\";\nimport UserPopover from \"components/sections/UserPopover\";\nimport useGetCurrentGuild from \"hooks/useGetCurrentGuild\";\nimport React, { useState } from \"react\";\nimport { Item, Menu, theme, useContextMenu } from \"react-contexify\";\nimport { FaEllipsisH, FaRegTrashAlt } from \"react-icons/fa\";\nimport { FiLink } from \"react-icons/fi\";\nimport { MdEdit } from \"react-icons/md\";\nimport { useParams } from \"react-router-dom\";\nimport userStore from \"stores/userStore\";\nimport { getShortenedTime, getTime } from \"utils/dateUtils\";\nimport \"../css/ContextMenu.css\";\nimport MessageContent from \"./MessageContent\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Message({\n  message,\n  isCompact = false\n}) {\n  _s();\n\n  var _message$user$color, _message$user$nicknam;\n\n  const [showSettings, setShowSettings] = useState(false);\n  const current = userStore(state => state.current);\n  const isAuthor = (current === null || current === void 0 ? void 0 : current.id) === message.user.id;\n  const {\n    guildId\n  } = useParams();\n  const guild = useGetCurrentGuild(guildId);\n  const isOwner = guild !== undefined && guild.ownerId === (current === null || current === void 0 ? void 0 : current.id);\n  const showMenu = isAuthor || isOwner || message.url;\n  const {\n    isOpen: isDeleteOpen,\n    onOpen: onDeleteOpen,\n    onClose: onDeleteClose\n  } = useDisclosure();\n  const {\n    isOpen: isEditOpen,\n    onOpen: onEditOpen,\n    onClose: onEditClose\n  } = useDisclosure();\n  const id = `${message.user.id}-${Math.random().toString(36).substr(2, 5)}`;\n  const {\n    show\n  } = useContextMenu({\n    id: message.id\n  });\n  const {\n    show: profileShow\n  } = useContextMenu({\n    id\n  });\n\n  const openInNewTab = url => {\n    const newWindow = window.open(url, \"_blank\", \"noopener,noreferrer\");\n    if (newWindow) newWindow.opener = null;\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Flex, {\n      alignItems: \"center\",\n      mr: \"1\",\n      mt: isCompact ? \"0\" : \"3\",\n      _hover: {\n        bg: \"brandGray.hover\"\n      },\n      justify: \"space-between\",\n      onMouseLeave: () => setShowSettings(false),\n      onMouseEnter: () => setShowSettings(true),\n      children: /*#__PURE__*/_jsxDEV(Flex, {\n        w: \"full\",\n        children: isCompact ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Box, {\n            ml: \"3\",\n            minW: \"44px\",\n            textAlign: \"center\",\n            children: /*#__PURE__*/_jsxDEV(Text, {\n              fontSize: \"10px\",\n              color: \"brandGray.accent\",\n              mt: \"1\",\n              hidden: !showSettings,\n              children: getShortenedTime(message.createdAt)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 65,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            ml: \"3\",\n            w: \"full\",\n            onContextMenu: show,\n            children: /*#__PURE__*/_jsxDEV(MessageContent, {\n              message: message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 76,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 15\n          }, this), showSettings && showMenu ? /*#__PURE__*/_jsxDEV(Box, {\n            onClick: show,\n            mr: \"2\",\n            _hover: {\n              cursor: \"pointer\"\n            },\n            h: \"5px\",\n            children: /*#__PURE__*/_jsxDEV(FaEllipsisH, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(Box, {\n            mr: \"6\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(UserPopover, {\n            member: message.user,\n            children: /*#__PURE__*/_jsxDEV(Avatar, {\n              h: \"40px\",\n              w: \"40px\",\n              ml: \"4\",\n              mt: \"1\",\n              src: message.user.image,\n              _hover: {\n                cursor: \"pointer\"\n              },\n              onContextMenu: e => {\n                if (!isAuthor) profileShow(e);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            ml: \"3\",\n            w: \"full\",\n            onContextMenu: show,\n            children: [/*#__PURE__*/_jsxDEV(Flex, {\n              alignItems: \"center\",\n              justify: \"space-between\",\n              children: [/*#__PURE__*/_jsxDEV(Flex, {\n                alignItems: \"center\",\n                children: [/*#__PURE__*/_jsxDEV(Text, {\n                  color: (_message$user$color = message.user.color) !== null && _message$user$color !== void 0 ? _message$user$color : undefined,\n                  children: (_message$user$nicknam = message.user.nickname) !== null && _message$user$nicknam !== void 0 ? _message$user$nicknam : message.user.username\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 111,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Text, {\n                  fontSize: \"12px\",\n                  color: \"brandGray.accent\",\n                  ml: \"2\",\n                  children: getTime(message.createdAt)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 114,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 19\n              }, this), showSettings && showMenu && /*#__PURE__*/_jsxDEV(Box, {\n                onClick: show,\n                mr: \"2\",\n                _hover: {\n                  cursor: \"pointer\"\n                },\n                children: /*#__PURE__*/_jsxDEV(FaEllipsisH, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 120,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(MessageContent, {\n              message: message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this), showMenu && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Menu, {\n        id: message.id,\n        theme: theme.dark,\n        children: [message.filetype ? /*#__PURE__*/_jsxDEV(Item, {\n          className: \"menu-item\",\n          onClick: () => {\n            if (message.url) openInNewTab(message.url);\n          },\n          children: /*#__PURE__*/_jsxDEV(Flex, {\n            align: \"center\",\n            justify: \"space-between\",\n            w: \"full\",\n            children: [/*#__PURE__*/_jsxDEV(Text, {\n              children: \"Open Link\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Icon, {\n              as: FiLink\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 15\n        }, this) : !isAuthor ? null : /*#__PURE__*/_jsxDEV(Item, {\n          className: \"menu-item\",\n          onClick: onEditOpen,\n          children: /*#__PURE__*/_jsxDEV(Flex, {\n            align: \"center\",\n            justify: \"space-between\",\n            w: \"full\",\n            children: [/*#__PURE__*/_jsxDEV(Text, {\n              children: \"Edit Message\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Icon, {\n              as: MdEdit\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 15\n        }, this), (isAuthor || isOwner) && /*#__PURE__*/_jsxDEV(Item, {\n          onClick: onDeleteOpen,\n          className: \"delete-item\",\n          children: /*#__PURE__*/_jsxDEV(Flex, {\n            align: \"center\",\n            justify: \"space-between\",\n            w: \"full\",\n            children: [/*#__PURE__*/_jsxDEV(Text, {\n              children: \"Delete Message\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Icon, {\n              as: FaRegTrashAlt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 11\n      }, this), isDeleteOpen && /*#__PURE__*/_jsxDEV(DeleteMessageModal, {\n        message: message,\n        isOpen: isDeleteOpen,\n        onClose: onDeleteClose\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }, this), isEditOpen && /*#__PURE__*/_jsxDEV(EditMessageModal, {\n        message: message,\n        isOpen: isEditOpen,\n        onClose: onEditClose\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true), !isAuthor && /*#__PURE__*/_jsxDEV(MemberContextMenu, {\n      member: message.user,\n      isOwner: isOwner,\n      id: id\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Message, \"hE9+9U6GI8iqStBSKxOEZ9HD5m4=\", false, function () {\n  return [useParams, useGetCurrentGuild, useDisclosure, useDisclosure, useContextMenu, useContextMenu];\n});\n\n_c = Message;\n\nvar _c;\n\n$RefreshReg$(_c, \"Message\");","map":{"version":3,"sources":["/Users/paulndam/Documents/MERN/React-Course/Crash-Course/build-discord/client/src/components/items/message/Message.js"],"names":["Avatar","Box","Flex","Icon","Text","useDisclosure","MemberContextMenu","DeleteMessageModal","EditMessageModal","UserPopover","useGetCurrentGuild","React","useState","Item","Menu","theme","useContextMenu","FaEllipsisH","FaRegTrashAlt","FiLink","MdEdit","useParams","userStore","getShortenedTime","getTime","MessageContent","Message","message","isCompact","showSettings","setShowSettings","current","state","isAuthor","id","user","guildId","guild","isOwner","undefined","ownerId","showMenu","url","isOpen","isDeleteOpen","onOpen","onDeleteOpen","onClose","onDeleteClose","isEditOpen","onEditOpen","onEditClose","Math","random","toString","substr","show","profileShow","openInNewTab","newWindow","window","open","opener","bg","createdAt","cursor","image","e","color","nickname","username","dark","filetype"],"mappings":"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","sourcesContent":["import { Avatar, Box, Flex, Icon, Text, useDisclosure } from \"@chakra-ui/react\";\nimport MemberContextMenu from \"components/menus/MemberContextMenu\";\nimport DeleteMessageModal from \"components/modals/DeleteMessageModal\";\nimport EditMessageModal from \"components/modals/EditMessageModal\";\nimport UserPopover from \"components/sections/UserPopover\";\nimport useGetCurrentGuild from \"hooks/useGetCurrentGuild\";\nimport React, { useState } from \"react\";\nimport { Item, Menu, theme, useContextMenu } from \"react-contexify\";\nimport { FaEllipsisH, FaRegTrashAlt } from \"react-icons/fa\";\nimport { FiLink } from \"react-icons/fi\";\nimport { MdEdit } from \"react-icons/md\";\nimport { useParams } from \"react-router-dom\";\nimport userStore from \"stores/userStore\";\nimport { getShortenedTime, getTime } from \"utils/dateUtils\";\nimport \"../css/ContextMenu.css\";\nimport MessageContent from \"./MessageContent\";\n\nexport default function Message({ message, isCompact = false }) {\n  const [showSettings, setShowSettings] = useState(false);\n  const current = userStore((state) => state.current);\n  const isAuthor = current?.id === message.user.id;\n  const { guildId } = useParams();\n  const guild = useGetCurrentGuild(guildId);\n  const isOwner = guild !== undefined && guild.ownerId === current?.id;\n  const showMenu = isAuthor || isOwner || message.url;\n\n  const {\n    isOpen: isDeleteOpen,\n    onOpen: onDeleteOpen,\n    onClose: onDeleteClose,\n  } = useDisclosure();\n  const {\n    isOpen: isEditOpen,\n    onOpen: onEditOpen,\n    onClose: onEditClose,\n  } = useDisclosure();\n  const id = `${message.user.id}-${Math.random().toString(36).substr(2, 5)}`;\n\n  const { show } = useContextMenu({\n    id: message.id,\n  });\n\n  const { show: profileShow } = useContextMenu({ id });\n\n  const openInNewTab = (url) => {\n    const newWindow = window.open(url, \"_blank\", \"noopener,noreferrer\");\n    if (newWindow) newWindow.opener = null;\n  };\n\n  return (\n    <>\n      <Flex\n        alignItems=\"center\"\n        mr=\"1\"\n        mt={isCompact ? \"0\" : \"3\"}\n        _hover={{ bg: \"brandGray.hover\" }}\n        justify=\"space-between\"\n        onMouseLeave={() => setShowSettings(false)}\n        onMouseEnter={() => setShowSettings(true)}\n      >\n        <Flex w={\"full\"}>\n          {isCompact ? (\n            <>\n              <Box ml={\"3\"} minW={\"44px\"} textAlign={\"center\"}>\n                <Text\n                  fontSize={\"10px\"}\n                  color=\"brandGray.accent\"\n                  mt={\"1\"}\n                  hidden={!showSettings}\n                >\n                  {getShortenedTime(message.createdAt)}\n                </Text>\n              </Box>\n\n              <Box ml=\"3\" w={\"full\"} onContextMenu={show}>\n                <MessageContent message={message} />\n              </Box>\n              {showSettings && showMenu ? (\n                <Box\n                  onClick={show}\n                  mr=\"2\"\n                  _hover={{ cursor: \"pointer\" }}\n                  h={\"5px\"}\n                >\n                  <FaEllipsisH />\n                </Box>\n              ) : (\n                <Box mr={\"6\"} />\n              )}\n            </>\n          ) : (\n            <>\n              <UserPopover member={message.user}>\n                <Avatar\n                  h=\"40px\"\n                  w=\"40px\"\n                  ml=\"4\"\n                  mt={\"1\"}\n                  src={message.user.image}\n                  _hover={{\n                    cursor: \"pointer\",\n                  }}\n                  onContextMenu={(e) => {\n                    if (!isAuthor) profileShow(e);\n                  }}\n                />\n              </UserPopover>\n              <Box ml=\"3\" w={\"full\"} onContextMenu={show}>\n                <Flex alignItems=\"center\" justify={\"space-between\"}>\n                  <Flex alignItems={\"center\"}>\n                    <Text color={message.user.color ?? undefined}>\n                      {message.user.nickname ?? message.user.username}\n                    </Text>\n                    <Text fontSize=\"12px\" color=\"brandGray.accent\" ml=\"2\">\n                      {getTime(message.createdAt)}\n                    </Text>\n                  </Flex>\n                  {showSettings && showMenu && (\n                    <Box onClick={show} mr=\"2\" _hover={{ cursor: \"pointer\" }}>\n                      <FaEllipsisH />\n                    </Box>\n                  )}\n                </Flex>\n                <MessageContent message={message} />\n              </Box>\n            </>\n          )}\n        </Flex>\n      </Flex>\n      {showMenu && (\n        <>\n          <Menu id={message.id} theme={theme.dark}>\n            {message.filetype ? (\n              <Item\n                className={\"menu-item\"}\n                onClick={() => {\n                  if (message.url) openInNewTab(message.url);\n                }}\n              >\n                <Flex align=\"center\" justify=\"space-between\" w=\"full\">\n                  <Text>Open Link</Text>\n                  <Icon as={FiLink} />\n                </Flex>\n              </Item>\n            ) : !isAuthor ? null : (\n              <Item className={\"menu-item\"} onClick={onEditOpen}>\n                <Flex align=\"center\" justify=\"space-between\" w=\"full\">\n                  <Text>Edit Message</Text>\n                  <Icon as={MdEdit} />\n                </Flex>\n              </Item>\n            )}\n            {(isAuthor || isOwner) && (\n              <Item onClick={onDeleteOpen} className={\"delete-item\"}>\n                <Flex align=\"center\" justify=\"space-between\" w=\"full\">\n                  <Text>Delete Message</Text>\n                  <Icon as={FaRegTrashAlt} />\n                </Flex>\n              </Item>\n            )}\n          </Menu>\n          {isDeleteOpen && (\n            <DeleteMessageModal\n              message={message}\n              isOpen={isDeleteOpen}\n              onClose={onDeleteClose}\n            />\n          )}\n          {isEditOpen && (\n            <EditMessageModal\n              message={message}\n              isOpen={isEditOpen}\n              onClose={onEditClose}\n            />\n          )}\n        </>\n      )}\n      {!isAuthor && (\n        <MemberContextMenu member={message.user} isOwner={isOwner} id={id} />\n      )}\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}