{"ast":null,"code":"import _regeneratorRuntime from\"/Users/paulndam/Documents/MERN/React-Course/Crash-Course/build-discord/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/paulndam/Documents/MERN/React-Course/Crash-Course/build-discord/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/paulndam/Documents/MERN/React-Course/Crash-Course/build-discord/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{Link as RLink,useHistory,useParams}from\"react-router-dom\";import{Box,Flex,Image,Link,Text}from\"@chakra-ui/react\";import{joinGuild}from\"api/handler/guilds\";import{gKey}from\"utils/querykeys\";import{useQueryClient}from\"react-query\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Invite(){var _useParams=useParams(),link=_useParams.link;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),errors=_useState2[0],setErrors=_useState2[1];var cache=useQueryClient();var history=useHistory();useEffect(function(){function handleJoin(){return _handleJoin.apply(this,arguments);}function _handleJoin(){_handleJoin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$joinGuild,data,_error$response,status,_error$response2,_error$response2$data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return joinGuild({link:link});case 3:_yield$joinGuild=_context.sent;data=_yield$joinGuild.data;if(data){cache.invalidateQueries(gKey);history.push(\"/channels/\".concat(data.id,\"/\").concat(data.default_channel_id));}_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);status=_context.t0===null||_context.t0===void 0?void 0:(_error$response=_context.t0.response)===null||_error$response===void 0?void 0:_error$response.status;if(status===400||status===404){setErrors({link:_context.t0===null||_context.t0===void 0?void 0:(_error$response2=_context.t0.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message});}else{setErrors(\"Something went wrong please try later\");}case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return _handleJoin.apply(this,arguments);}handleJoin();},[link,history,cache]);return/*#__PURE__*/_jsx(Flex,{minHeight:\"100vh\",align:\"center\",justify:\"center\",h:\"full\",children:/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",children:[/*#__PURE__*/_jsx(Flex,{mb:\"4\",justify:\"center\",children:/*#__PURE__*/_jsx(Image,{src:\"/logo.png\",w:\"80px\"})}),/*#__PURE__*/_jsx(Text,{children:\"Fetching server info. Please wait.\"}),/*#__PURE__*/_jsx(Text,{children:\"You will be automatically redirected.\"}),errors&&/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Text,{my:\"2\",textColor:\"menuRed\",children:errors}),/*#__PURE__*/_jsxs(Text,{children:[\"Click\",\" \",/*#__PURE__*/_jsx(Link,{as:RLink,to:\"/channels/me\",color:\"highlight.standard\",children:\"here\"}),\" \",\"to return.\"]})]})]})});}","map":{"version":3,"sources":["/Users/paulndam/Documents/MERN/React-Course/Crash-Course/build-discord/client/src/pages/Invite.js"],"names":["React","useEffect","useState","Link","RLink","useHistory","useParams","Box","Flex","Image","Text","joinGuild","gKey","useQueryClient","Invite","link","errors","setErrors","cache","history","handleJoin","data","invalidateQueries","push","id","default_channel_id","status","response","message"],"mappings":"ykBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,IAAI,GAAIC,CAAAA,KAAjB,CAAwBC,UAAxB,CAAoCC,SAApC,KAAqD,kBAArD,CACA,OAASC,GAAT,CAAcC,IAAd,CAAoBC,KAApB,CAA2BN,IAA3B,CAAiCO,IAAjC,KAA6C,kBAA7C,CACA,OAASC,SAAT,KAA0B,oBAA1B,CACA,OAASC,IAAT,KAAqB,iBAArB,CACA,OAASC,cAAT,KAA+B,aAA/B,C,wFAEA,cAAe,SAASC,CAAAA,MAAT,EAAkB,gBACdR,SAAS,EADK,CACvBS,IADuB,YACvBA,IADuB,eAEHb,QAAQ,CAAC,IAAD,CAFL,wCAExBc,MAFwB,eAEhBC,SAFgB,eAG/B,GAAMC,CAAAA,KAAK,CAAGL,cAAc,EAA5B,CACA,GAAMM,CAAAA,OAAO,CAAGd,UAAU,EAA1B,CAEAJ,SAAS,CAAC,UAAM,SACCmB,CAAAA,UADD,wIACd,iQAE2BT,CAAAA,SAAS,CAAC,CAAEI,IAAI,CAAJA,IAAF,CAAD,CAFpC,uCAEYM,IAFZ,kBAEYA,IAFZ,CAGI,GAAIA,IAAJ,CAAU,CACRH,KAAK,CAACI,iBAAN,CAAwBV,IAAxB,EACAO,OAAO,CAACI,IAAR,qBAA0BF,IAAI,CAACG,EAA/B,aAAqCH,IAAI,CAACI,kBAA1C,GACD,CANL,+EAQUC,MARV,kEAQmB,YAAOC,QAR1B,0CAQmB,gBAAiBD,MARpC,CASI,GAAIA,MAAM,GAAK,GAAX,EAAkBA,MAAM,GAAK,GAAjC,CAAsC,CACpCT,SAAS,CAAC,CAAEF,IAAI,mEAAE,YAAOY,QAAT,kEAAE,iBAAiBN,IAAnB,gDAAE,sBAAuBO,OAA/B,CAAD,CAAT,CACD,CAFD,IAEO,CACLX,SAAS,CAAC,uCAAD,CAAT,CACD,CAbL,oEADc,6CAiBdG,UAAU,GACX,CAlBQ,CAkBN,CAACL,IAAD,CAAOI,OAAP,CAAgBD,KAAhB,CAlBM,CAAT,CAoBA,mBACE,KAAC,IAAD,EAAM,SAAS,CAAC,OAAhB,CAAwB,KAAK,CAAC,QAA9B,CAAuC,OAAO,CAAC,QAA/C,CAAwD,CAAC,CAAC,MAA1D,uBACE,MAAC,GAAD,EAAK,SAAS,CAAE,QAAhB,wBACE,KAAC,IAAD,EAAM,EAAE,CAAC,GAAT,CAAa,OAAO,CAAC,QAArB,uBACE,KAAC,KAAD,EAAO,GAAG,CAAC,WAAX,CAAuB,CAAC,CAAC,MAAzB,EADF,EADF,cAIE,KAAC,IAAD,iDAJF,cAKE,KAAC,IAAD,oDALF,CAMGF,MAAM,eACL,MAAC,GAAD,yBACE,KAAC,IAAD,EAAM,EAAE,CAAC,GAAT,CAAa,SAAS,CAAC,SAAvB,UACGA,MADH,EADF,cAIE,MAAC,IAAD,oBACQ,GADR,cAEE,KAAC,IAAD,EAAM,EAAE,CAAEZ,KAAV,CAAiB,EAAE,CAAC,cAApB,CAAmC,KAAK,CAAC,oBAAzC,kBAFF,CAIU,GAJV,gBAJF,GAPJ,GADF,EADF,CAyBD","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Link as RLink, useHistory, useParams } from \"react-router-dom\";\nimport { Box, Flex, Image, Link, Text } from \"@chakra-ui/react\";\nimport { joinGuild } from \"api/handler/guilds\";\nimport { gKey } from \"utils/querykeys\";\nimport { useQueryClient } from \"react-query\";\n\nexport default function Invite() {\n  const { link } = useParams();\n  const [errors, setErrors] = useState(null);\n  const cache = useQueryClient();\n  const history = useHistory();\n\n  useEffect(() => {\n    async function handleJoin() {\n      try {\n        const { data } = await joinGuild({ link });\n        if (data) {\n          cache.invalidateQueries(gKey);\n          history.push(`/channels/${data.id}/${data.default_channel_id}`);\n        }\n      } catch (error) {\n        const status = error?.response?.status;\n        if (status === 400 || status === 404) {\n          setErrors({ link: error?.response?.data?.message });\n        } else {\n          setErrors(\"Something went wrong please try later\");\n        }\n      }\n    }\n    handleJoin();\n  }, [link, history, cache]);\n\n  return (\n    <Flex minHeight=\"100vh\" align=\"center\" justify=\"center\" h=\"full\">\n      <Box textAlign={\"center\"}>\n        <Flex mb=\"4\" justify=\"center\">\n          <Image src=\"/logo.png\" w=\"80px\" />\n        </Flex>\n        <Text>Fetching server info. Please wait.</Text>\n        <Text>You will be automatically redirected.</Text>\n        {errors && (\n          <Box>\n            <Text my=\"2\" textColor=\"menuRed\">\n              {errors}\n            </Text>\n            <Text>\n              Click{\" \"}\n              <Link as={RLink} to=\"/channels/me\" color=\"highlight.standard\">\n                here\n              </Link>{\" \"}\n              to return.\n            </Text>\n          </Box>\n        )}\n      </Box>\n    </Flex>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}